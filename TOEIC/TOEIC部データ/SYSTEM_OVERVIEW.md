# 📖 TOEIC部管理システム - 全体概要

## 🎯 目的

週次で開催しているTOEIC部の活動を効率化し、各メンバーに最適化された学習体験を提供するシステム。

## 🏗️ システムアーキテクチャ

```
┌─────────────────────────────────────────────────────────┐
│                    TOEIC部管理システム                     │
└─────────────────────────────────────────────────────────┘
                              │
            ┌─────────────────┼─────────────────┐
            │                 │                 │
    ┌───────▼───────┐ ┌──────▼──────┐ ┌───────▼───────┐
    │  問題生成器    │ │  データ管理  │ │  分析エンジン  │
    └───────────────┘ └─────────────┘ └───────────────┘
```

### 1. 問題生成器（`generate_problem.py`）

**機能:**
- Cursor AIを使ったTOEIC Part 7問題の自動生成
- パラメータ調整可能（パッセージ数、難易度、トピック）
- プロンプトテンプレート管理

**入力:**
- パッセージ数（1-3）
- 質問数
- 難易度（初級/中級/上級）
- トピック（任意）

**出力:**
- Markdown形式の問題ファイル
- 自動採番された問題番号

### 2. データ管理（`toeic_club.py`）

**機能:**
- メンバー情報管理
- 問題データベース管理
- 結果データベース管理
- CSVインポート/エクスポート

**データストア:**
- `members.yaml`: メンバー情報（3人）
- `problems_db.json`: 生成した問題の記録
- `results_db.json`: セッション結果の記録

### 3. 分析エンジン（`toeic_club.py`内）

**機能:**
- 個人別統計（正答率、問題タイプ別成績）
- 弱点特定（正答率60%未満の問題タイプ）
- 全体統計（メンバー別サマリー）
- レコメンデーション（次回の最適設定提案）

## 📊 データフロー

```
1. 問題生成
   generate_problem.py → Cursor AI → 問題.md

2. 問題登録
   問題.md → toeic_club.py register-problem → problems_db.json

3. セッション実施
   問題を解く → スプレッドシートに記録

4. 結果インポート
   CSV → toeic_club.py import-results → results_db.json

5. 分析
   results_db.json → toeic_club.py analyze → 統計レポート

6. レコメンデーション
   分析結果 → toeic_club.py recommend → 次回の推奨設定
```

## 🧩 主要コンポーネント

### A. プロンプトエンジン（`prompts.py`）

TOEICテストに準拠した問題生成プロンプトを管理。

**特徴:**
- システムプロンプト（専門家ペルソナ）
- パラメータ化された生成プロンプト
- 出力形式の厳密な定義

### B. 設定管理（`config.yaml`）

システム全体の設定を一元管理。

**設定項目:**
- デフォルト値（パッセージ数、難易度等）
- 出力ディレクトリ
- 難易度レベル定義
- トピックオプション

### C. データモデル

#### メンバー（`members.yaml`）
```yaml
- id: "member_001"
  name: "nakato"
  target_score: 800
  current_level: "上級"
  joined_date: "2025-01-01"
```

#### 問題（`problems_db.json`）
```json
{
  "problem_id": "prob_130_134",
  "file_name": "130-134.md",
  "question_range": [130, 134],
  "passages": 2,
  "difficulty": "中級",
  "questions_count": 5,
  "created_at": "2025-11-06T..."
}
```

#### 結果（`results_db.json`）
```json
{
  "date": "2025-11-06",
  "session_number": 1,
  "facilitator": "nakato",
  "problem_file": "130-134.md",
  "results": [
    {
      "question_number": 130,
      "question_type": "detail",
      "member_id": "member_001",
      "answer": "A",
      "is_correct": true,
      "time_spent_seconds": 45
    }
  ]
}
```

### D. 分析アルゴリズム

#### 正答率計算
```
正答率 = (正解数 / 総問題数) × 100
```

#### 弱点特定
```
問題タイプごとの正答率 < 60% かつ 問題数 ≥ 2
```

#### 難易度推奨
```
正答率 ≥ 80% → 難易度UP
正答率 < 50% → 難易度DOWN
それ以外 → 現状維持
```

#### パッセージ数推奨
```
正答率 ≥ 70% → 2パッセージ（複数文書に慣れる）
正答率 < 70% → 1パッセージ（集中学習）
```

## 🔄 ワークフローの最適化

### 従来の方法
1. 手動で問題を探す（時間がかかる）
2. 全員同じ問題を解く（個別最適化なし）
3. 結果を記録するが分析しない（データが活かされない）

### 新システム
1. **自動問題生成**（数分で完了）
2. **個別最適化**（各メンバーの弱点に対応）
3. **データドリブン**（分析→推奨→生成のサイクル）

## 🚀 今後の拡張可能性

### Phase 2: 自動化の強化
- [ ] 弱点に特化した問題の自動生成
- [ ] スプレッドシートとの直接連携（Google Sheets API）
- [ ] 問題タイプの自動分類（AI判定）

### Phase 3: 高度な分析
- [ ] 学習曲線の可視化
- [ ] TOEICスコア予測モデル
- [ ] メンバー間の相対評価

### Phase 4: Webアプリ化
- [ ] ブラウザベースのダッシュボード
- [ ] リアルタイム解答システム
- [ ] 自動レポート生成

### Phase 5: AIコーチング
- [ ] 個別学習プランの自動生成
- [ ] 弱点克服のための教材推薦
- [ ] チャットボットによる学習サポート

## 💻 技術スタック

- **言語**: Python 3.x
- **AI**: Cursor AI（Claude Sonnet 4.5）
- **データ形式**: YAML, JSON, CSV
- **依存関係**: PyYAML

## 📈 成功指標

1. **効率化**: 問題準備時間を50%削減
2. **個別最適化**: 各メンバーの弱点にフォーカス
3. **継続性**: データ蓄積により長期的な成長を追跡
4. **エンゲージメント**: メンバーのモチベーション維持

## 🎓 設計思想

### 1. シンプルさ優先
- CLIベース（学習曲線が低い）
- ファイルベース（データベース不要）
- 段階的な機能追加

### 2. データドリブン
- すべての結果を記録
- 分析に基づく意思決定
- 継続的な改善

### 3. 柔軟性
- パラメータ調整可能
- カスタマイズしやすい
- 拡張性を考慮した設計

### 4. 実用性
- 実際のワークフローに即している
- オンライン活動に対応
- 週次のリズムに最適化

## 🤝 メンバー構成への配慮

**3人体制の最適化:**
- 小規模グループに適したシンプルな設計
- 個人の差異が大きい（800点 vs 300-400点）ため、個別最適化が重要
- 輪番制ファシリテーションをサポート

## 📝 まとめ

このシステムは、TOEIC部の活動を：
- **効率化**（自動生成）
- **個別最適化**（データ分析）
- **継続可能**（データ蓄積）

にすることで、メンバー全員のスコアアップをサポートします。

---

**作成日**: 2025年11月6日
**バージョン**: 1.0.0

